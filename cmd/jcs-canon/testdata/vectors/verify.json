[
  {
    "name": "verify canonical object",
    "args": ["verify", "--quiet", "-"],
    "stdin": "{\"a\":1}",
    "exit_code": 0
  },
  {
    "name": "verify canonical primitive",
    "args": ["verify", "--quiet", "-"],
    "stdin": "42",
    "exit_code": 0
  },
  {
    "name": "reject unsorted object",
    "args": ["verify", "--quiet", "-"],
    "stdin": "{\"b\":1,\"a\":2}",
    "exit_code": 2,
    "stderr_contains": ["not canonical"]
  },
  {
    "name": "reject duplicate key",
    "args": ["verify", "--quiet", "-"],
    "stdin": "{\"a\":1,\"a\":2}",
    "exit_code": 2,
    "stderr_contains": ["duplicate object key"]
  },
  {
    "name": "reject lone surrogate",
    "args": ["verify", "--quiet", "-"],
    "stdin": "\"\\uD800\"",
    "exit_code": 2,
    "stderr_contains": ["lone high surrogate"]
  },
  {
    "name": "reject noncharacter",
    "args": ["verify", "--quiet", "-"],
    "stdin": "\"\\uFDD0\"",
    "exit_code": 2,
    "stderr_contains": ["noncharacter"]
  },
  {
    "name": "reject negative zero as non-canonical",
    "args": ["verify", "--quiet", "-"],
    "stdin": "-0",
    "exit_code": 2,
    "stderr_contains": ["not canonical"]
  },
  {
    "name": "reject underflow-as-zero as non-canonical",
    "args": ["verify", "--quiet", "-"],
    "stdin": "1e-400",
    "exit_code": 2,
    "stderr_contains": ["not canonical"]
  },
  {
    "name": "reject trailing whitespace",
    "args": ["verify", "--quiet", "-"],
    "stdin": "{\"a\":1}\n",
    "exit_code": 2,
    "stderr_contains": ["not canonical"]
  },
  {
    "name": "reject invalid utf8",
    "args": ["verify", "--quiet", "-"],
    "stdin_hex": "22fffe22",
    "exit_code": 2,
    "stderr_contains": ["not valid UTF-8"]
  }
]
